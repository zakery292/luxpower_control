<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>LuxPower Control DB</title>
    <link rel="stylesheet" href="./static/styles.css">
    <link href="https://cdn.materialdesignicons.com/5.4.55/css/materialdesignicons.min.css" rel="stylesheet">
</head>
<body>
    <header>
        <h1>LuxPower Control DB</h1>
    </header>
    <div class="main-container">
        <aside class="sidebar">
            <div class="table-links">
                <h3>Tables</h3>
                {% for table in tables %}
                    <form action="./" method="post">
                        <input type="hidden" name="table_select" value="{{ table[0] }}">
                        <button type="submit" class="table-button">{{ table[0] }}</button>
                    </form>
                {% endfor %}
                <div class="table-info">
                    <p>Rows: {{ total_rows }}</p>
                    <p>Last Updated: {{ last_updated }}</p> <!-- This will need backend support -->
                </div>
            </aside>
        <div class="table-container">
            <div id="table1" class="dynamic-table"></div>
            <div id="table2" class="dynamic-table"></div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const table1 = document.getElementById('table1');
            const table2 = document.getElementById('table2');
            let loading = false;

            function loadMoreData() {
                if (loading) return;
                loading = true;

                // Fetch data from the server
                fetch(`/load-data?offset=${table1.children.length}`)
                    .then(response => response.json())
                    .then(data => {
                        data.forEach((row, index) => {
                            const table = index % 2 === 0 ? table1 : table2;
                            const tr = document.createElement('tr');
                            // Populate table rows
                            table.appendChild(tr);
                        });
                        loading = false;
                    });
            }

            // Infinite scroll logic
            window.addEventListener('scroll', function() {
                if (window.scrollY + window.innerHeight >= document.body.offsetHeight) {
                    loadMoreData();
                }
            });

            // Initial load
            loadMore
Data();
});
</script>

</body>
</html>
